

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CMAQ Tutorial &mdash; CMAQ 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            CMAQ
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../Docs_README.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">     User's Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html">     Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html"><strong>Developers’ Guide for the Community Multiscale Air Quality (CMAQ) Modeling System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html#motivation">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html#summary-of-developer-workflow">Summary of Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html#development-life-cycle">Development Life-cycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html#making-contributions">Making Contributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html#copyright-information">Copyright Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Developers_Guide/CMAQ_Dev_Guide.html#appendix">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">MIT License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">CMAQ</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CMAQ Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Users_Guide/Tutorials/CMAQ_UG_tutorial_emissions.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cmaq-tutorial">
<h1>CMAQ Tutorial<a class="headerlink" href="#cmaq-tutorial" title="Link to this heading"></a></h1>
<section id="prescribing-emissions-using-desid-detailed-emissions-scaling-isolation-and-diagnostics-module">
<h2>Prescribing Emissions Using DESID (Detailed Emissions Scaling, Isolation and Diagnostics) Module<a class="headerlink" href="#prescribing-emissions-using-desid-detailed-emissions-scaling-isolation-and-diagnostics-module" title="Link to this heading"></a></h2>
<p>Purpose: This tutorial will guide users to utilizing the DESID Control namelists to perform some basic manipulation
of their emission streams. For additional questions, contact Ben Murphy (murphy.ben&#64;epa.gov) or visit the CMAS Forum.</p>
</section>
<hr class="docutils" />
<section id="definitions-of-terms">
<h2>Definitions of Terms<a class="headerlink" href="#definitions-of-terms" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Stream: An Online emission source or a group of sources processed offline and read into CMAQ from one file. Common
examples of streams include biogenic VOCs, mobile sources, wind-blown dust, prescribed fires, electric-generating units,
residential heating, etc.</p></li>
<li><p>Species: A variable representing a chemical compound or group of compounds in CMAQ.</p></li>
<li><p>Surrogate: A variable representing a chemical compound or group of compounds on an emission Stream.</p></li>
</ul>
</section>
<section id="important-notes-to-remember">
<h2>Important Notes to Remember<a class="headerlink" href="#important-notes-to-remember" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Rules are applied in the order they are provided.</p></li>
</ul>
</section>
<section id="example-use-cases">
<h2>Example Use Cases<a class="headerlink" href="#example-use-cases" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#zero_out"><span class="xref myst">1. Zero out emissions</span></a></p></li>
<li><p><a class="reference internal" href="#add_emissions"><span class="xref myst">2. Add emissions for a new tracer species</span></a></p></li>
<li><p><a class="reference internal" href="#scale_stream"><span class="xref myst">3. Scale emissions from one stream by a common factor</span></a></p></li>
<li><p><a class="reference internal" href="#scale_species"><span class="xref myst">4. Scale emissions for one species on all streams</span></a></p></li>
<li><p><a class="reference internal" href="#scale_gases"><span class="xref myst">5. Scale all gas phase emissions but leave aerosols alone</span></a></p></li>
<li><p><a class="reference internal" href="#scale_aerosols"><span class="xref myst">6. Scale all aerosols</span></a></p></li>
<li><p><a class="reference internal" href="#%5B#add_surrogate"><span class="xref myst">7. Add or subtract emissions from one surrogate to existing emissions</span></a></p></li>
<li><p><a class="reference internal" href="#overwrite"><span class="xref myst">8. Overwrite the scale factor for a single stream or species</span></a></p></li>
<li><p><a class="reference internal" href="#scale_all_but_one"><span class="xref myst">9. Scale all species except one by a common factor</span></a></p></li>
<li><p><a class="reference internal" href="#scale_moles_mass"><span class="xref myst">10. Apply scaling while conserving moles or mass</span></a></p></li>
<li><p><a class="reference internal" href="#apply_mask"><span class="xref myst">11. Apply scaling with spatial dependence</span></a></p></li>
<li><p><a class="reference internal" href="#define_families"><span class="xref myst">12. Define families of streams, regions, or chemical species</span></a></p></li>
<li><p><a class="reference internal" href="#fam_stream"><span class="xref myst">13. Use a family of streams to scale emissions for a group of sources</span></a></p></li>
<li><p><a class="reference internal" href="#fam_region"><span class="xref myst">14. Use a family of regions to scale emissions in a new location</span></a></p></li>
<li><p><a class="reference internal" href="#fam_chem"><span class="xref myst">15. Use a family of species to scale emissions for a custom group of pollutants</span></a></p></li>
<li><p><a class="reference internal" href="#appendix1"><span class="xref myst">A1. Appendix: Example Emission Control File</span></a></p></li>
<li><p><a class="reference internal" href="#appendix2"><span class="xref myst">A2. Appendix: Example Emissions Section of CCTM RunScript File</span></a></p></li>
</ul>
<p><a id=zero_out></a></p>
</section>
<section id="zero-out-emissions">
<h2>1. Zero Out Emissions<a class="headerlink" href="#zero-out-emissions" title="Link to this heading"></a></h2>
<p>Emission streams can be zeroed using the options for individual streams in the CMAQ RunScript or creating rules in the DESID Chemical Mapping Control Namelist.</p>
<section id="a-using-options-in-the-cmaq-runscript">
<h3>a. Using Options in the CMAQ RunScript<a class="headerlink" href="#a-using-options-in-the-cmaq-runscript" title="Link to this heading"></a></h3>
<p>For gridded or inline emissions, reduce the value of N_EMIS_GR or N_EMIS_PT, respectively and adjust the values of the file paths and stream labels accordingly, if necessary.</p>
<p>Note that if you zero out the sea-spray or wind-blown dust emissions, you should also edit the emission control file by commenting out the coarse and fine species expected from those modules. Some of these species are used by both emission streams, so if you only want to zero out the sea-spray or dust stream but not the other stream, you will need to determine which species to comment out. Please check the AERO_DATA module for the list of species produced by each stream.</p>
<p>Alternatively, you may set the CTM_EMISCHK variable to FALSE in the runscript to avoid crashing CMAQ if it cannot find species it is looking for from emissions streams that have been disabled.</p>
<p>To zero Sea Spray aerosol emissions,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CTM_OCEAN_CHEM</span> <span class="n">N</span>
</pre></div>
</div>
<p>To zero Wind-Blown Dust aerosol emissions,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CTM_WB_DUST</span> <span class="n">N</span>
</pre></div>
</div>
<p>To zero online Biogenic VOC emissions calculated by BEIS,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CTM_BIOGEMIS</span> <span class="n">N</span>
</pre></div>
</div>
<p>To zero Lightning NO emissions,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CTM_LTNG_NO</span> <span class="n">N</span>
</pre></div>
</div>
</section>
<section id="b-creating-rules-in-the-chemical-mapping-control-namelist">
<h3>b. Creating Rules in the Chemical Mapping Control Namelist<a class="headerlink" href="#b-creating-rules-in-the-chemical-mapping-control-namelist" title="Link to this heading"></a></h3>
<p>All streams can be zeroed by creating a rule that refers to ‘All’ streams. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39; , &#39;All&#39;          ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,0.    ,&#39;UNIT&#39;,&#39;o&#39;,
</pre></div>
</div>
<p>Alternatively, individual streams can be zeroed by creating rules that refer to specific streams.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;SEASPRAY&#39;    ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,0.    ,&#39;UNIT&#39;,&#39;o&#39;,
&#39;EVERYWHERE&#39;  , &#39;WBDUST&#39;      ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,0.    ,&#39;UNIT&#39;,&#39;o&#39;,
&#39;EVERYWHERE&#39;  , &#39;BIOG&#39;        ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,0.    ,&#39;UNIT&#39;,&#39;o&#39;,
&#39;EVERYWHERE&#39;  , &#39;LTNG&#39;        ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,0.    ,&#39;UNIT&#39;,&#39;o&#39;,
&#39;EVERYWHERE&#39;  , &#39;MOBILE&#39;      ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,0.    ,&#39;UNIT&#39;,&#39;o&#39;,
</pre></div>
</div>
<p>The last rule assumes that one of the emissions streams has been labeled ‘MOBILE’ in the RunScript. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">GR_EMIS_LAB_001</span> <span class="n">MOBILE</span>
</pre></div>
</div>
<p><a id=add_emissions></a></p>
</section>
</section>
<section id="add-emissions-for-a-new-chemical-species">
<h2>2. Add Emissions For a New Chemical Species<a class="headerlink" href="#add-emissions-for-a-new-chemical-species" title="Link to this heading"></a></h2>
<p>If a species is named “CHEMX” on the gas, aerosol, or nonreactive namelist, then a rule can be created on the Chemical Maping Control Namelist that will link that new species to any existing surrogate from the emission streams. In this example, CHEMX is scaled to 25% of NO emissions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;NO&#39;     ,&#39;CHEMX&#39;       ,&#39;All&#39; ,0.25  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>Note that the ‘a’ operator is important here to create the new link from ‘CHEMX’ to NO. If we want to scale to 25% of total NO<sub>x</sub> concentrations, we can add a line to include NO<sub>2</sub>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;NO&#39;     ,&#39;CHEMX&#39;       ,&#39;All&#39; ,0.25  ,&#39;UNIT&#39;,&#39;a&#39;,
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;NO2&#39;    ,&#39;CHEMX&#39;       ,&#39;All&#39; ,0.25  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p><a id=scale_stream></a></p>
</section>
<section id="scale-emissions-from-one-stream-by-a-common-factor">
<h2>3. Scale emissions from one stream by a common factor<a class="headerlink" href="#scale-emissions-from-one-stream-by-a-common-factor" title="Link to this heading"></a></h2>
<p>The following rule in the Chemical Maping Control Namelist will scale all emissions from one example stream (“MOBILE”) by a factor of 2. The operator ‘m’ will multiply the cumulative value of all scale factors that have been applied for the “MOBILE” stream to that point.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;MOBILE&#39;      ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,2.0  ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p><a id=scale_species></a></p>
</section>
<section id="scale-emissions-for-one-species-on-all-streams">
<h2>4. Scale emissions for one species on all streams<a class="headerlink" href="#scale-emissions-for-one-species-on-all-streams" title="Link to this heading"></a></h2>
<p>To scale emissions for one species, in this case elemental (or black) carbon, on all streams by a factor of 0.5 (50%), use the following rule:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;All&#39;    ,&#39;AEC&#39;         ,&#39;All&#39; ,0.5  ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p><a id=scale_gases></a></p>
</section>
<section id="scale-all-gas-phase-emissions-but-leave-aerosols-alone">
<h2>5. Scale all gas phase emissions but leave aerosols alone<a class="headerlink" href="#scale-all-gas-phase-emissions-but-leave-aerosols-alone" title="Link to this heading"></a></h2>
<p>If the user wants to target all gas-phase emissions broadly, but leave aerosol emissions alone, the “Phase/Mode” field may be used. The following rule scales all gas-phase emissions by 66%.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;GAS&#39; ,0.66  ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p>And this rule is just for one stream, for example, the hypothetical “MOBILE” stream:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;MOBILE&#39;      ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;GAS&#39; ,0.66  ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p><a id=scale_aerosols></a></p>
</section>
<section id="scale-all-aerosols">
<h2>6. Scale all aerosols<a class="headerlink" href="#scale-all-aerosols" title="Link to this heading"></a></h2>
<p>If instead, the user is interested in scaling all aerosol species by a factor of 3.0 and leaving gas-phase emissions alone, a rule of this form may be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;AERO&#39;,3.0  ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p><a id=scale_surrogate></a></p>
</section>
<section id="add-or-subtract-emissions-from-one-surrogate-to-existing-emissions">
<h2>7. Add or subtract emissions from one surrogate to existing emissions<a class="headerlink" href="#add-or-subtract-emissions-from-one-surrogate-to-existing-emissions" title="Link to this heading"></a></h2>
<p>If the following rule is already present on the default emission control namelist,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;TOL&#39;    ,&#39;TOL&#39;         ,&#39;GAS&#39; ,1.0  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>and the user wants to add or subtract toluene emissions based on the value of a different emission surrogate, CO for example, then this rule could be used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;CO&#39;     ,&#39;TOL&#39;         ,&#39;GAS&#39; ,0.1  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>This rule adds more toluene emissions at the rate of 10% of CO emissions to every stream that has CO emissions. If the user wants to subtract 10% of CO emissions instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;CO&#39;     ,&#39;TOL&#39;         ,&#39;GAS&#39; ,-0.1  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>Note it is important to use the ‘a’ operator for these rules since the effects of these rules should be added to existing scale factors.</p>
<p><a id=overwrite></a></p>
</section>
<section id="overwrite-the-scale-factor-for-a-single-stream-or-species">
<h2>8. Overwrite the scale factor for a single stream or species<a class="headerlink" href="#overwrite-the-scale-factor-for-a-single-stream-or-species" title="Link to this heading"></a></h2>
<p>If the following rule is already present on the default emission control namelist,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;TOL&#39;    ,&#39;TOL&#39;         ,&#39;GAS&#39; ,1.0  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>and the user wants to overwrite the scale factor with a different one, 30% for example, use a rule of this form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;TOL&#39;    ,&#39;TOL&#39;         ,&#39;GAS&#39; ,0.3 ,&#39;UNIT&#39;,&#39;o&#39;,
</pre></div>
</div>
<p><a id=scale_all_but_one></a></p>
</section>
<section id="scale-all-species-except-one-by-a-common-factor">
<h2>9. Scale all species except one by a common factor<a class="headerlink" href="#scale-all-species-except-one-by-a-common-factor" title="Link to this heading"></a></h2>
<p>Putting examples 3 and 8 together then can give us this desired result. If the Chemical Mapping Control Namelist already has unity scaling for all emissions by default, then the user may scale all emissions from all streams by a factor of 2.0. Then the user can reset the scale factor of one species, NO for example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;GAS&#39; ,2.0 ,&#39;UNIT&#39;,&#39;m&#39;,
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;NO&#39;     ,&#39;NO&#39;          ,&#39;GAS&#39; ,1.0 ,&#39;UNIT&#39;,&#39;o&#39;,
</pre></div>
</div>
<p><a id=scale_moles_mass></a></p>
</section>
<section id="apply-scaling-while-conserving-moles-or-mass">
<h2>10. Apply scaling while conserving moles or mass<a class="headerlink" href="#apply-scaling-while-conserving-moles-or-mass" title="Link to this heading"></a></h2>
<p>The user may elect to conserve moles or mass instead of applying factors directly using the “Basis” field. For example, the rule</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;CO&#39;     ,&#39;ANO3&#39;        ,&#39;FINE&#39; ,0.15 ,&#39;MASS&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>will add 15% of CO emissions to the emissions of fine-mode particulate nitrate, but the scale factor will also be adjusted by multiplying by the molecular weight of CO to conserve mass.</p>
<p>Reminder: gas-phase emission rates are usually provided to CMAQ in molar units while particle emissions are usually provided in mass. Note that if the user scales a particle species to a gas surrogate, or vice-versa, it is important in most cases to choose either “MASS” or “MOLE” appropriately for the Basis to ensure proper unit conversions.</p>
<p>If the user is scaling one gas species to another gas surrogate, both will likely have molar emissions units. In this case, selecting “MOLE” as the basis will be equivalent to selecting “UNIT”. In other words, there will be no modification of the user-defined scale factor due to unit conversion concerns. If, however, “MASS” is selected, then the scale factor will be modified by first multiplying by the molecular weight of the surrogate and then dividing by the molecular weight of the CMAQ species.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;All&#39;         ,&#39;CO&#39;     ,&#39;ETHYLBENZ&#39;   ,&#39;GAS&#39; ,0.003 ,&#39;MASS&#39;,&#39;a&#39;,
</pre></div>
</div>
<p><a id=apply_mask></a></p>
</section>
<section id="apply-scaling-with-spatial-dependence">
<h2>11. Apply scaling with spatial dependence<a class="headerlink" href="#apply-scaling-with-spatial-dependence" title="Link to this heading"></a></h2>
<p>The user may apply a scale factor to a specific area of the domain by identifying the name of the mask to be used in the emission rule. For example, this rule increases all emissions in “KENTUCKY” by 50%:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;KENTUCKY&#39;    , &#39;All&#39;         ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,1.50 ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p>The label for “KENTUCKY” should be linked to a specific gridded variable mask (of real numbers) using the “Desid_RegionDef” section on the <a class="reference internal" href="#../../../CCTM/src/emis/emis/CMAQ_Control_DESID.nml"><span class="xref myst">DESID Control Namelist</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;Desid_RegionDef
 RGN_NML  =   
 !          | Region Label   | File_Label  | Variable on File
 !&lt;Default&gt;    &#39;EVERYWHERE&#39;  ,&#39;N/A&#39;        ,&#39;N/A&#39;,
 !&lt;Example&gt;    &#39;WATER&#39;       ,&#39;CMAQ_MASKS&#39; ,&#39;OPEN&#39;,
 !&lt;Example&gt;    &#39;ALL&#39;         ,&#39;CMAQ_MASKS&#39; ,&#39;ALL&#39;,
               &#39;KENTUCKY&#39;    ,&#39;CMAQ_STATES&#39;,&#39;KY&#39;,
/
</pre></div>
</div>
<p>This is just an example of defining one mask named “KENTUCKY”. For a complete explanation of the spatial-dependent scaling feature, see the CMAQ Appendix <a class="reference internal" href="../Appendix/CMAQ_UG_appendixB_emissions_control.html"><span class="std std-doc">B.3.4 “Defining and Using Regions and Region Families”</span></a>.</p>
<p>Two example mask files are available on the CMAS Data Warehouse: US states grid mask file and NOAA climate regions grid mask file.  These mask files can be used with the 12US1 modeling grid domain (grid origin x = -2556000 m, y = -1728000 m; N columns = 459, N rows = 299).</p>
<ul class="simple">
<li><p><a class="reference external" href="https://drive.google.com/drive/folders/1x9mJUbKjJaMDFawgy2PUbETwEUopAQDl">Link to grid mask files on CMAS Data Warehouse Google Drive</a></p></li>
<li><p><a class="reference external" href="https://doi.org/10.15139/S3/XDYYB9">Link to metadata for the grid mask files is posted on the CMAS Center Dataverse site</a></p></li>
</ul>
<p><a id=define_families></a></p>
</section>
<section id="define-families-of-streams-regions-or-chemical-species">
<h2>12.  Define families of streams, regions, or chemical species<a class="headerlink" href="#define-families-of-streams-regions-or-chemical-species" title="Link to this heading"></a></h2>
<p>Users can define any number of custom groups or “families” of emission streams, regions or chemical species to be used to streamline (i.e. enhance) prescribed emissions rules. For example, if a user would like to scale NOx by 50% from 4 different emission streams (e.g. PT_EGU, GRIDDED, MOBILE and PT_NONEGU) without using famlies, they would need 8 rules, one for NO and NO2 for each of 4 streams. However, by defining a family of 4 streams and another family of two chemical species (i.e. NOx), 1 rule can be used to achieve the same result.</p>
<p>Chemical families are defined by prescribing, via the <a class="reference internal" href="#../../../CCTM/src/util/util/CMAQ_Control_Misc.nml"><span class="xref myst">CMAQ Miscellaneous Control File</span></a>, the total number of chemical families to be used, the name of each, the number of members of each family, and the name of each family member. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">Chemical_FamVars</span>
 <span class="n">N_Chem_Fams</span> <span class="o">=</span> <span class="mi">2</span>
 <span class="n">Max_Chem_Fam_Members</span> <span class="o">=</span> <span class="mi">20</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">ChemicalFamilies</span>
 <span class="n">ChemFamilyName</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>     <span class="o">=</span> <span class="s1">&#39;NOX&#39;</span>    
 <span class="n">ChemFamilyNum</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>      <span class="o">=</span> <span class="mi">2</span>  
 <span class="n">ChemFamilyMembers</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span><span class="o">=</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span><span class="s1">&#39;NO2&#39;</span>  
 <span class="n">ChemFamilyName</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>     <span class="o">=</span> <span class="s1">&#39;POA&#39;</span>    
 <span class="n">ChemFamilyNum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="o">=</span> <span class="mi">2</span>  
 <span class="n">ChemFamilyMembers</span><span class="p">(</span><span class="mi">2</span><span class="p">,:)</span><span class="o">=</span> <span class="s1">&#39;POC&#39;</span><span class="p">,</span><span class="s1">&#39;PNCOM&#39;</span>  
<span class="o">/</span>
</pre></div>
</div>
<p>In this example, 2 chemical families, “NOX” and “POA”, are defined with 2 members, “NO” and “NO2”, and “POC” and “PNCOM”.</p>
<p>Stream families are defined analogously in the DESID Control File:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;Desid_StreamFamVars
 Desid_N_Stream_Fams = 3
 Desid_Max_Stream_Fam_Members = 20
/

&amp;Desid_StreamFam  
 ! General sources of POA
 StreamFamilyName(1)     = &#39;GENERAL_POA&#39;
 StreamFamilyMembers(1,1:5)= &#39;GRIDDED_OTHER&#39;,&#39;GRIDDED_SOLVENTS&#39;,&#39;PT_CANADA_SOLVENTS&#39;,&#39;PT_OTHER&#39;,&#39;PT_US_SOLVENTS&#39;

 ! Diesel-Like Sources
 StreamFamilyName(2)     = &#39;DIESEL&#39;
 StreamFamilyMembers(2,1:2)= &#39;GRIDDED_DIESEL&#39;,&#39;PT_CMV&#39;

 ! US and Canada Aircraft
 StreamFamilyName(3)     = &#39;AIRCRAFT&#39;
 StreamFamilyMembers(3,1:2)= &#39;GRIDDED_US_AIRCRAFT&#39;,&#39;PT_CANADA_AIRPORTS&#39;
/  
</pre></div>
</div>
<p>As are region families:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">Desid_RegionDefVars</span>
 <span class="n">Desid_Max_Reg</span>    <span class="o">=</span> <span class="mi">60</span>           
 <span class="n">Desid_N_Reg_Fams</span> <span class="o">=</span> <span class="mi">0</span>           
 <span class="n">Desid_Max_Reg_Fam_Members</span> <span class="o">=</span> <span class="mi">100</span> 
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">Desid_RegionFam</span>
 <span class="n">RegionFamilyName</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>     <span class="o">=</span> <span class="s1">&#39;SouthEastUS&#39;</span>
 <span class="n">RegionFamilyMembers</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span><span class="o">=</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span><span class="s1">&#39;VA&#39;</span><span class="p">,</span><span class="s1">&#39;TN&#39;</span><span class="p">,</span><span class="s1">&#39;NC&#39;</span><span class="p">,</span><span class="s1">&#39;MS&#39;</span><span class="p">,</span><span class="s1">&#39;AL&#39;</span><span class="p">,</span><span class="s1">&#39;GA&#39;</span><span class="p">,</span><span class="s1">&#39;SC&#39;</span><span class="p">,</span><span class="s1">&#39;FL&#39;</span>
<span class="o">/</span>
</pre></div>
</div>
<p><a id=fam_stream></a></p>
</section>
<section id="use-a-family-of-streams-to-scale-emissions-for-a-group-of-sources">
<h2>13. Use a family of streams to scale emissions for a group of sources<a class="headerlink" href="#use-a-family-of-streams-to-scale-emissions-for-a-group-of-sources" title="Link to this heading"></a></h2>
<p>To then use a stream family to apply a rule to multiple streams, just use the family name in the Stream Label column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label         |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |                      |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;DIESEL&#39;             ,&#39;NO2&#39;    ,&#39;NO2&#39;         ,&#39;GAS&#39; ,0.50 ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p><a id=fam_region></a></p>
</section>
<section id="use-a-family-of-regions-to-scale-emissions-in-a-new-location">
<h2>14. Use a family of regions to scale emissions in a new location<a class="headerlink" href="#use-a-family-of-regions-to-scale-emissions-in-a-new-location" title="Link to this heading"></a></h2>
<p>To use a region family, use the family name in the Region Label column.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label  |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |               |Surrogate| Species      |Mode  |Factor|      |
&#39;SouthEastUS&#39; , &#39;ALL&#39;         ,&#39;NO2&#39;    ,&#39;NO2&#39;         ,&#39;GAS&#39; ,0.50 ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p><a id=fam_chem></a></p>
</section>
<section id="use-a-family-of-species-to-scale-emissions-for-a-custom-group-of-pollutants">
<h2>15. Use a family of species to scale emissions for a custom group of pollutants<a class="headerlink" href="#use-a-family-of-species-to-scale-emissions-for-a-custom-group-of-pollutants" title="Link to this heading"></a></h2>
<p>Chemical families may be applied in the CMAQ-species column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |              |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;AIRCRAFT&#39;   ,&#39;ALL&#39;    ,&#39;NOX&#39;         ,&#39;GAS&#39; ,0.50 ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p>or in the Emission Surrogate column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |              |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;AIRCRAFT&#39;   ,&#39;NOX&#39;    ,&#39;ALL&#39;         ,&#39;GAS&#39; ,0.50 ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p>In both of these cases, both NO and NO2 (as NOx is defined above) are multiplied by 50%. The same is accomplished by using NOX in both columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |              |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;AIRCRAFT&#39;   ,&#39;NOX&#39;    ,&#39;NOX&#39;         ,&#39;GAS&#39; ,0.50 ,&#39;UNIT&#39;,&#39;m&#39;,
</pre></div>
</div>
<p>Because the ‘m’ operator is used, CMAQ will look for pre-existing relationships between the members of ‘NOX’ in order to apply the scaling rule, which ‘multiplies’ the existing scaling by 50%. So this example assumes that the following two rules, or something similar, preceed the instructions in this section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |              |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;AIRCRAFT&#39;   ,&#39;NO&#39;     ,&#39;NO&#39;          ,&#39;GAS&#39; ,1.00  ,&#39;UNIT&#39;,&#39;a&#39;,
&#39;EVERYWHERE&#39;  , &#39;AIRCRAFT&#39;   ,&#39;NO2&#39;    ,&#39;NO2&#39;         ,&#39;GAS&#39; ,1.00  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>In this case, CMAQ is adding a relationship between NO and NO2 surrogates and model species. Thus families are most useful when using the ‘m’ or ‘o’ operators.</p>
<p>However, sometimes the ‘a’ operator is useful with chemical families. In the example below, a relationship is added between POA surrogates (defined in example 12 above) and CMAQ model species:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>! Region      | Stream Label |Emission | CMAQ-        |Phase/|Scale |Basis |Op  
!  Label      |              |Surrogate| Species      |Mode  |Factor|      |
&#39;EVERYWHERE&#39;  , &#39;AIRCRAFT&#39;   ,&#39;POA&#39;    ,&#39;ALVPO1&#39;      ,&#39;FINE&#39;,0.09  ,&#39;UNIT&#39;,&#39;a&#39;,
</pre></div>
</div>
<p>CMAQ will use this rule to add POC and PNCOM surrogates together, multiply by 0.09 and assign their emissions to ALVPO1, a semivolatile POA species.<br />
The way CMAQ uses chemical families for adding relationships with the ‘a’ is nuanced. The following logic is applied:</p>
<ul class="simple">
<li><p>If a chemical family is used for either the emission variable or the CMAQ-Species but not both, then connections are made between each member of the family and the prescribed single-species in the other column.</p></li>
<li><p>If both columns include chemical families or the ‘ALL’ keyword, then each pair of members will be compared. If the names match exactly or a relationship already exists, then the ‘a’ operation will be applied. If not, then the pair will be ignored. This precaution is in place to protect against the case where a user prescribes an addition (i.e. ‘a’) rule with the keyword ‘ALL’ or very large chemical families in both the emission variable and CMAQ-Species columns.
Without the precaution in place, adding relationships for ALL surrogates to ALL model species would be an extremely large data structure and almost certainly not an intended use of CMAQ.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, CMAQ Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>